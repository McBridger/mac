# Задачи по улучшению Bridger (macOS)

1.  **Рефакторинг протокола сообщений:**
    *   Реализовать класс/структуру `BridgerMessage` для инкапсуляции логики кодирования/декодирования сообщений.
    *   Убедиться, что `BLEPeripheralManager` использует этот класс для всех операций с сообщениями.
    *   Оптимизировать обновление UI, чтобы оно корректно реагировало на изменения в `connectedDevices`.

2.  **Логика "State Your Name":**
    *   После подключения нового устройства (`didSubscribeTo`) запускать таймаут (например, N миллисекунд).
    *   В течение этого таймаута ожидать сообщение типа `DEVICE_NAME` от подключенного центрального устройства.
    *   Если сообщение `DEVICE_NAME` получено до истечения таймаута, обновить имя устройства и показать уведомление о подключении (с именем устройства).
    *   Если таймаут истек, а сообщение `DEVICE_NAME` не получено, принудительно отключить центральное устройство (`peripheralManager.cancelPeripheralConnection(central)`) и показать пользователю соответствующее уведомление (например, "Устройство не представилось и было отключено").
